import{_ as D,r as o,m as C,n as H,q as z,c as n,a as t,b as A,g as T,w as F,T as I,k as c,v as m,s as G,t as i,F as O,x as J,j as $,o as r,y as Q}from"./CAm5wNBU.js";const Y={class:"min-h-screen bg-gray-100 relative"},K={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},R={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},W={class:"flex-grow"},X={class:"bg-white rounded-lg shadow-lg p-6"},Z={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"},ee={class:"flex items-center gap-3 w-full md:w-2/3"},te={class:"flex items-center gap-2"},se={class:"w-full md:w-auto flex justify-end"},le={key:0,class:"text-center text-gray-600 py-10"},ae={key:1,class:"text-center text-red-500 py-10"},oe={key:2,class:"overflow-x-auto rounded-lg border border-gray-200"},ne={class:"min-w-full table-auto border-collapse"},re={class:"px-4 py-2"},ie={class:"px-4 py-2"},ue={class:"px-4 py-2"},de={class:"px-4 py-2"},pe={class:"px-4 py-2 whitespace-nowrap"},ce=["onClick"],ve=["onClick"],me={key:0},be={class:"mt-6 flex justify-center items-center gap-4"},we=["disabled"],fe={class:"text-gray-700"},xe=["disabled"],he={key:0,class:"fixed inset-0 flex items-start justify-center pt-24 backdrop-blur-sm z-50"},ye={class:"bg-white w-full max-w-lg mx-auto rounded-lg shadow-lg p-6 relative"},ge={class:"text-xl font-semibold mb-4"},_e={class:"mb-4"},ke={class:"mb-4"},Ue={class:"mb-4"},Ce=["required"],Te={class:"mb-4"},je={class:"mb-4"},Ee={class:"flex justify-end gap-2"},Me={type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},Ne={__name:"users",setup(Pe){const j=o([]),g=o(!1),x=o(null),b=o(!1),w=o(""),_=o("success"),u=o(!1),h=o(null),a=o({name:"",email:"",password:"",no_hp:"",alamat:"",role_id:2,created_by:1}),y=o(""),d=o(1),v=o(5),E=C(()=>{const l=y.value.toLowerCase();return j.value.filter(e=>[e.name,e.email,e.no_hp,e.alamat].some(s=>s==null?void 0:s.toLowerCase().includes(l)))}),M=C(()=>Math.ceil(E.value.length/v.value)),N=C(()=>{const l=(d.value-1)*v.value;return E.value.slice(l,l+v.value)});H([y,v],()=>{d.value=1});let p=null;function f(l,e){_.value=l,w.value=e,p&&clearTimeout(p),p=setTimeout(()=>{w.value="",p=null},4e3)}function P(){w.value="",p&&(clearTimeout(p),p=null)}async function k(){g.value=!0,x.value=null;try{const l=await fetch("http://localhost:8888/users");if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const e=await l.json();j.value=e??[]}catch(l){x.value=l.message}finally{g.value=!1}}function V(){a.value={name:"",email:"",password:"",no_hp:"",alamat:"",role_id:2,created_by:1},h.value=null,u.value=!1}function L(){b.value=!1,V()}function q(l){u.value=!0,h.value=l.user_id,a.value.name=l.name,a.value.email=l.email,a.value.password="",a.value.no_hp=l.no_hp,a.value.alamat=l.alamat,a.value.role_id=l.role_id||2,b.value=!0}async function B(){try{let l="http://localhost:8888/users",e="POST";u.value&&h.value&&(l+=`/${h.value}`,e="PUT");const s=await fetch(l,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.value.name,email:a.value.email,password:a.value.password,no_hp:a.value.no_hp,alamat:a.value.alamat,role_id:a.value.role_id,created_by:a.value.created_by})}),U=await s.json();if(!s.ok){f("error",U.error||"Gagal menyimpan data.");return}f("success",u.value?"User berhasil diupdate.":"User berhasil disimpan."),b.value=!1,await k(),V()}catch(l){f("error",l.message)}}async function S(l){if(confirm("Yakin ingin menghapus user ini?"))try{const e=await fetch(`http://localhost:8888/users/${l}`,{method:"DELETE"});if(!e.ok)throw new Error(`Gagal menghapus user, status: ${e.status}`);await k(),f("success","User berhasil dihapus.")}catch(e){f("error",`Error hapus user: ${e.message}`)}}return z(()=>{k()}),(l,e)=>(r(),n("div",Y,[e[22]||(e[22]=t("h1",{class:"text-2xl font-bold mb-6"},"Data User",-1)),A(I,{name:"fade"},{default:F(()=>[w.value?(r(),n("div",{key:0,onClick:P,class:Q([_.value==="success"?"bg-green-500 text-white":"bg-red-500 text-white","fixed top-6 right-6 flex items-center gap-3 px-4 py-3 rounded shadow-lg cursor-pointer z-50 select-none","max-w-xs","drop-shadow-lg"])},[_.value==="success"?(r(),n("svg",K,e[10]||(e[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)]))):(r(),n("svg",R,e[11]||(e[11]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1)]))),t("span",W,i(w.value),1),t("button",{onClick:$(P,["stop"]),"aria-label":"Close",class:"ml-2 focus:outline-none"},e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))],2)):T("",!0)]),_:1}),t("div",X,[t("div",Z,[t("div",ee,[c(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),placeholder:"Cari data...",class:"flex-grow px-4 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,y.value]]),t("div",te,[e[14]||(e[14]=t("label",{class:"text-gray-700"},"Tampilkan",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),class:"px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},e[13]||(e[13]=[t("option",{value:5},"5",-1),t("option",{value:10},"10",-1),t("option",{value:20},"20",-1)]),512),[[G,v.value,void 0,{number:!0}]])])]),t("div",se,[t("button",{onClick:e[2]||(e[2]=s=>b.value=!0),class:"bg-blue-500 text-white px-5 py-2 rounded hover:bg-blue-600"}," + Tambah User ")])]),g.value?(r(),n("div",le,"Loading data...")):x.value?(r(),n("div",ae,"Error: "+i(x.value),1)):(r(),n("div",oe,[t("table",ne,[e[16]||(e[16]=t("thead",{class:"bg-blue-600 text-white"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left"},"Nama"),t("th",{class:"px-4 py-3 text-left"},"Email"),t("th",{class:"px-4 py-3 text-left"},"No HP"),t("th",{class:"px-4 py-3 text-left"},"Alamat"),t("th",{class:"px-4 py-3 text-left"},"Aksi")])],-1)),t("tbody",null,[(r(!0),n(O,null,J(N.value,s=>(r(),n("tr",{key:s.user_id,class:"border-b hover:bg-gray-50"},[t("td",re,i(s.name),1),t("td",ie,i(s.email),1),t("td",ue,i(s.no_hp),1),t("td",de,i(s.alamat),1),t("td",pe,[t("button",{onClick:U=>q(s),class:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 mr-2"}," Edit ",8,ce),t("button",{onClick:U=>S(s.user_id),class:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"}," Hapus ",8,ve)])]))),128)),N.value.length===0?(r(),n("tr",me,e[15]||(e[15]=[t("td",{colspan:"5",class:"text-center text-gray-500 py-4"},"Data tidak ditemukan.",-1)]))):T("",!0)])])])),t("div",be,[t("button",{onClick:e[3]||(e[3]=s=>d.value--),disabled:d.value===1,class:"px-4 py-2 bg-blue-500 text-white rounded disabled:opacity-50"}," ← Prev ",8,we),t("span",fe,"Halaman "+i(d.value)+" dari "+i(M.value),1),t("button",{onClick:e[4]||(e[4]=s=>d.value++),disabled:d.value===M.value,class:"px-4 py-2 bg-blue-500 text-white rounded disabled:opacity-50"}," Next → ",8,xe)])]),b.value?(r(),n("div",he,[t("div",ye,[t("h2",ge,i(u.value?"Edit User":"Tambah User"),1),t("form",{onSubmit:$(B,["prevent"])},[t("div",_e,[e[17]||(e[17]=t("label",{class:"block mb-1"},"Nama",-1)),c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.name=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[m,a.value.name]])]),t("div",ke,[e[18]||(e[18]=t("label",{class:"block mb-1"},"Email",-1)),c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.email=s),type:"email",class:"w-full border rounded px-3 py-2",required:""},null,512),[[m,a.value.email]])]),t("div",Ue,[e[19]||(e[19]=t("label",{class:"block mb-1"},"Password",-1)),c(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.password=s),type:"password",class:"w-full border rounded px-3 py-2",required:!u.value,placeholder:"Isi password baru jika ingin mengubah"},null,8,Ce),[[m,a.value.password]])]),t("div",Te,[e[20]||(e[20]=t("label",{class:"block mb-1"},"No HP",-1)),c(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.no_hp=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[m,a.value.no_hp]])]),t("div",je,[e[21]||(e[21]=t("label",{class:"block mb-1"},"Alamat",-1)),c(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.alamat=s),class:"w-full border rounded px-3 py-2",required:""},null,512),[[m,a.value.alamat]])]),t("div",Ee,[t("button",{type:"button",onClick:L,class:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"}," Batal "),t("button",Me,i(u.value?"Update":"Simpan"),1)])],32)])])):T("",!0)]))}},$e=D(Ne,[["__scopeId","data-v-4f39eb66"]]);export{$e as default};
